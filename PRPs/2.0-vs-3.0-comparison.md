---
name: 2.0 vs 3.0门店升级效果对比分析
description: 基于真实销售数据的门店升级前后多维度对比分析与投资决策支持
version: 1.0.0
created: 2025-10-27
quality_score: 9/10
---
# 2.0 vs 3.0门店升级效果对比分析

## 📋 功能概述

### 业务背景

餐饮企业完成门店从2.0版本到3.0版本的升级改造，需要通过客观数据分析评估升级效果，为投资决策提供数据支持。

### 核心目标

1. **数据标准化**: 将3.0门店数据对齐到2.0基线标准结构
2. **多维度对比**: 覆盖8个核心经营指标的环比分析
3. **时段细分**: 4个关键维度按4个时段深度拆解
4. **可视化呈现**: 生成专业级HTML投资者仪表板
5. **数据完整性**: 确保分析基于真实数据，缺失数据明确标注并提出补足建议

### 分析维度

**8大核心维度**:

1. **客单价** (Average Transaction Value) - 需时段拆解
2. **客流量** (Customer Traffic) - 需时段拆解
3. **老产品销量/销售额** (Old Product Sales/Revenue)
4. **新产品销量/销售额** (New Product Sales/Revenue)
5. **人效** (Labor Efficiency)
6. **毛利率** (Gross Margin) - 需时段拆解
7. **翻座率** (Table Turnover Rate)
8. **营业额** (Total Revenue) - 需时段拆解

**4个时段划分** (适用于维度1/2/6/8):

- 早餐时段: 11:00之前
- 午餐高峰: 11:00-13:00
- 晚餐高峰: 17:00-20:00
- 其他时段: 13:00-17:00 + 20:00之后

### 数据来源

- **2.0基线报告**: `input/情报组/【2.0 VS 3.0】产品销售对比/客单价.xlsx`
- **3.0对比报告**: input/情报组/【2.0 VS 3.0】产品销售对比/吼巷_全渠道订单明细_20251027_0208_1761556082620.xlsx
  input/情报组/【2.0 VS 3.0】产品销售对比/吼巷_销售品项统计_2025-10-27_02_11_52_a899380r_1761556312749.xlsx
  input/情报组/【2.0 VS 3.0】产品销售对比/吼巷_营业概览_20251027_0143_a899380r_1761554593716.xlsx

---

## 🔍 上下文与参考

### 文档引用

**Python数据处理库**:

- pandas官方文档: https://pandas.pydata.org/docs/
- openpyxl文档: https://openpyxl.readthedocs.io/en/stable/
- Excel文件读取最佳实践: https://pandas.pydata.org/docs/user_guide/io.html#excel-files

**餐饮行业KPI分析**:

- 客单价计算公式: 营业额 ÷ 客流量
- 翻座率计算公式: 客流量 ÷ 座位数
- 人效计算公式: 营业额 ÷ 员工数量
- 毛利率计算公式: (营业额 - 成本) ÷ 营业额 × 100%

**数据可视化**:

- Glassmorphism设计规范: https://css.glass/
- Chart.js文档: https://www.chartjs.org/docs/latest/
- HTML报表最佳实践: https://developer.mozilla.org/en-US/docs/Web/HTML

### 代码示例

**Excel文件读取**:

```python
import pandas as pd

# 读取Excel文件
df_2_0 = pd.read_excel('input/情报组/【2.0 VS 3.0】产品销售对比/客单价.xlsx')
df_3_0 = pd.read_excel('input/情报组/【2.0 VS 3.0】产品销售对比/吼巷_营业概览_20251027_0143_a899380r_1761554593716.xlsx')

# 查看数据结构
print(df_2_0.columns.tolist())
print(df_2_0.head())
```

**环比分析计算**:

```python
def calculate_change_rate(baseline, comparison):
    """计算环比增长率"""
    if baseline == 0:
        return None  # 基线为0时无法计算
    return ((comparison - baseline) / baseline) * 100

# 示例
change_rate = calculate_change_rate(
    baseline=df_2_0['客单价'].mean(),
    comparison=df_3_0['客单价'].mean()
)
```

**时段数据拆解**:

```python
import datetime

def classify_time_period(time_str):
    """分类时段"""
    hour = datetime.datetime.strptime(time_str, '%H:%M').hour
    if hour < 11:
        return '早餐时段'
    elif 11 <= hour < 13:
        return '午餐高峰'
    elif 17 <= hour < 20:
        return '晚餐高峰'
    else:
        return '其他时段'

# 应用分类
df['时段'] = df['时间'].apply(classify_time_period)
df_by_period = df.groupby('时段').agg({
    '客单价': 'mean',
    '客流量': 'sum',
    '营业额': 'sum'
})
```

### 技术陷阱

**陷阱1: Excel文件格式不一致**

- **问题**: 2.0和3.0报表可能存在列名不一致、数据类型不匹配
- **解决方案**:
  - 先分析2.0基线结构，建立标准字段映射表
  - 使用字段映射将3.0数据对齐到2.0标准
  - 记录所有数据转换规则

**陷阱2: 时间字段解析错误**

- **问题**: Excel时间可能存储为序列号、字符串或datetime对象
- **解决方案**:
  - 使用 `pd.to_datetime()`统一转换
  - 设置 `errors='coerce'`处理异常值
  - 验证转换后的时间范围合理性

**陷阱3: 数据缺失处理不当**

- **问题**: 直接忽略或臆造缺失数据会导致分析失真
- **解决方案**:
  - 明确标记缺失数据 (使用NaN或特殊标识)
  - 在报告中明确说明数据缺失情况
  - 提出补足数据的具体建议 (如需补充哪些时段/维度的数据)
  - **严禁臆造数据**

**陷阱4: 环比计算分母为零**

- **问题**: 基线数据为0时计算环比会出错
- **解决方案**:
  - 增加分母检查逻辑
  - 返回None或特殊标识 (如"N/A")
  - 在报告中说明"基线为0无法计算环比"

### 实现模式

**模式1: 智能体协作工作流**

本项目采用**智能体自动匹配与协作**模式，而非传统代码结构：

```yaml
工作流编排原则:
  - 相关任务环节智能匹配相关智能体进行
  - 各智能体按专业领域协作完成任务
  - 数据流在智能体间自动传递
  - 质量把控由智能体自主验证

智能体匹配策略:
  数据采集阶段:
    - 文件读取与解析 → E2-Chrome网页采集 或 开发组F3-数据库开发
    - Excel结构分析 → E4-深度情报分析

  数据处理阶段:
    - 数据清洗与对齐 → E4-深度情报分析 + F5-后端开发
    - 环比计算与统计 → G1-经营分析优化师
    - 时段拆解分析 → G1-经营分析优化师

  可视化阶段:
    - HTML报表设计 → F1-前端开发 + X4-图文排版师
    - 数据图表制作 → F1-前端开发
    - Glassmorphism样式 → F2-组件开发

  质量保障:
    - 数据完整性验证 → E4-深度情报分析
    - 计算准确性验证 → G1-经营分析优化师
    - 视觉呈现验证 → X4-图文排版师

跨组协作场景:
  场景1 (数据采集与分析):
    E2/F3 → E4 → G1

  场景2 (分析与可视化):
    G1 → F1 → F2 → X4

  场景3 (完整链路):
    E2/F3 → E4 → G1 → F1/F2/X4 → 成果交付
```

**模式2: 数据完整性保障机制**

```yaml
数据完整性原则:
  1. 真实性优先:
     - 所有分析必须基于真实数据
     - 严禁臆造或虚构任何数据

  2. 缺失数据处理:
     - 明确标记缺失字段 (使用NaN或"数据缺失"标识)
     - 在报告中说明缺失数据的影响
     - 提出补足数据的具体建议:
       * 缺失的维度/时段
       * 建议的数据来源
       * 补充数据的优先级

  3. 异常数据处理:
     - 标记异常值 (如客单价为负数)
     - 不直接删除，保留原始值
     - 在报告中说明异常情况

  4. 计算失败处理:
     - 基线为0导致无法计算环比 → 标记"N/A"
     - 时间字段解析失败 → 标记"时间格式错误"
     - 必填字段缺失 → 标记"数据不完整"

数据验证检查点:
  ✅ 2.0基线文件是否成功读取
  ✅ 3.0对比文件是否成功读取
  ✅ 8个维度数据是否完整
  ✅ 时段拆解所需时间字段是否存在
  ✅ 数值字段类型是否正确
  ✅ 环比计算分母是否为0
  ✅ 缺失数据是否已标记
  ✅ 补足建议是否已提出
```

---

## 🎯 实现蓝图

### 智能体协作流程设计

**阶段1: 数据解析与结构分析**

```
任务: 解析2.0基线Excel文件，理解标准数据结构
智能体匹配: E4-深度情报分析 + F3-数据库开发
输入: input/情报组/【2.0 VS 3.0】产品销售对比/客单价.xlsx
输出:
  - 2.0数据结构文档 (字段清单、数据类型、样本数据)
  - 标准字段定义表
验证: 成功提取所有列名和前5行样本数据
```

**阶段2: 3.0数据采集与对齐**

```
任务: 解析3.0对比Excel文件，对齐到2.0标准结构
智能体匹配: E4-深度情报分析 + F5-后端开发
输入:
  - input/情报组/【2.0 VS 3.0】产品销售对比/吼巷_营业概览_20251027_0143_a899380r_1761554593716.xlsx
  - 2.0标准字段定义表
输出:
  - 3.0原始数据结构文档
  - 字段映射关系表 (3.0字段 → 2.0标准字段)
  - 对齐后的3.0标准化数据集
验证: 3.0数据字段与2.0完全对齐，数据类型一致
```

**阶段3: 多维度环比分析**

```
任务: 对8个维度进行环比分析计算
智能体匹配: G1-经营分析优化师
输入:
  - 2.0基线数据集
  - 3.0标准化数据集
输出:
  - 8个维度的环比分析结果 (包含基线值、对比值、增长率、增长绝对值)
  - 缺失数据清单 (如有)
  - 异常数据标记 (如有)
计算公式:
  - 环比增长率 = (3.0值 - 2.0值) / 2.0值 × 100%
  - 环比增长额 = 3.0值 - 2.0值
验证: 所有可计算维度均有环比结果，分母为0的情况已标记
```

**阶段4: 时段细分分析**

```
任务: 对维度1/2/6/8进行4时段拆解分析
智能体匹配: G1-经营分析优化师
输入:
  - 2.0基线数据集 (含时间字段)
  - 3.0标准化数据集 (含时间字段)
输出:
  - 4个维度 × 4个时段 = 16组环比分析结果
  - 时段分类规则应用日志
  - 时间字段异常记录 (如有)
时段规则:
  - 早餐时段: < 11:00
  - 午餐高峰: 11:00-12:59
  - 晚餐高峰: 17:00-19:59
  - 其他时段: 13:00-16:59 + ≥20:00
验证: 16组数据均有环比结果，时间字段解析成功率≥95%
```

**阶段5: 数据完整性审查**

```
任务: 审查所有分析结果的数据完整性
智能体匹配: E4-深度情报分析
输入:
  - 8个维度环比分析结果
  - 16组时段细分结果
  - 原始数据集
输出:
  - 数据完整性报告:
    * 完整数据清单 (✅)
    * 缺失数据清单 (❌ 缺失维度/时段/字段)
    * 异常数据清单 (⚠️ 异常值/计算失败)
  - 补足建议清单:
    * 建议补充的数据项
    * 建议的数据来源
    * 补充优先级 (高/中/低)
验证: 所有缺失和异常情况已标记，补足建议已提出
```

**阶段6: HTML可视化设计**

```
任务: 设计并实现Glassmorphism风格HTML投资者仪表板
智能体匹配: F1-前端开发 + F2-组件开发 + X4-图文排版师
输入:
  - 8个维度环比分析结果
  - 16组时段细分结果
  - 数据完整性报告
输出:
  - 独立HTML文件 (包含CSS和JavaScript)
  - 响应式布局 (支持桌面和平板)
  - Glassmorphism视觉效果 (半透明毛玻璃效果)
  - 数据图表 (柱状图/折线图/雷达图)
  - 缺失数据标记 (明确展示)
设计要求:
  - 专业投资者仪表板风格
  - 数据清晰易读
  - 缺失数据醒目标注
  - 补足建议独立区域展示
验证: HTML在浏览器中正确渲染，所有数据正确展示
```

**阶段7: 成果交付**

```
任务: 生成HTML报告截图并整理交付物
智能体匹配: F1-前端开发
输入:
  - 完成的HTML文件
输出:
  - HTML报告截图 (PNG格式)
  - 完整交付包:
    * HTML报告文件
    * 报告截图
    * 数据完整性报告
    * 补足建议清单
    * 数据对齐说明文档
验证: 截图清晰可读，交付包完整
```

### 文件结构

```
ZTL数智化作战中心/
├── PRPs/
│   └── 2.0-vs-3.0-comparison.md  # 本PRP文档
│
├── input/
│   └── 情报组/
│       └── 【2.0 VS 3.0】产品销售对比/
│           ├── 客单价.xlsx  # 2.0基线报告
│           └── 吼巷_营业概览_20251027_0143_a899380r_1761554593716.xlsx  # 3.0对比报告
│
└── output/
    └── 情报组/
        └── 2.0-vs-3.0-comparison-[timestamp]/
            ├── report.html  # 最终HTML投资者仪表板
            ├── report.png  # HTML报告截图
            ├── data_integrity_report.md  # 数据完整性报告
            ├── supplement_suggestions.md  # 补足建议清单
            └── alignment_log.json  # 数据对齐日志
```

### 错误处理策略

**错误类型1: 文件读取失败**

```yaml
场景: Excel文件不存在、权限不足、格式损坏
处理:
  - 捕获异常: FileNotFoundError, PermissionError
  - 日志记录: 文件路径、错误类型、错误详情
  - 用户提示: "无法读取文件 [路径]，请检查文件是否存在和权限设置"
  - 终止流程: 无法继续后续分析
```

**错误类型2: 字段映射失败**

```yaml
场景: 3.0数据字段与2.0标准无法对应
处理:
  - 记录无法映射的字段列表
  - 生成字段差异报告
  - 用户提示: "以下字段无法对应到2.0标准: [字段列表]"
  - 策略选择:
    * 手动补充映射规则
    * 标记为"未映射字段"
    * 排除无法映射的字段
```

**错误类型3: 数据类型不匹配**

```yaml
场景: 数值字段包含非数字字符、时间字段无法解析
处理:
  - 尝试自动转换: pd.to_numeric(errors='coerce')
  - 记录转换失败的行号和原始值
  - 标记为异常值: NaN或特殊标识
  - 生成异常数据报告
  - 用户提示: "发现 [N] 条数据类型异常，已标记为缺失值"
```

**错误类型4: 环比计算失败**

```yaml
场景: 分母为0导致除零错误
处理:
  - 增加分母检查: if baseline == 0
  - 返回特殊值: None 或 "N/A"
  - 日志记录: 维度名称、基线值、对比值
  - 报告标注: "该维度基线为0，无法计算环比"
```

**错误类型5: 时段分类失败**

```yaml
场景: 时间字段格式不符合预期、时间范围异常
处理:
  - 捕获datetime解析异常
  - 记录解析失败的行号和原始值
  - 标记为"时段未知"
  - 生成时间字段异常报告
  - 用户提示: "发现 [N] 条时间数据异常，已排除时段分析"
```

**错误类型6: HTML渲染失败**

```yaml
场景: 数据格式导致JavaScript错误、浏览器兼容性问题
处理:
  - 验证JSON数据格式
  - 使用try-catch包裹JavaScript代码
  - 提供降级方案: 纯表格展示
  - 日志记录: 错误类型、浏览器信息
  - 用户提示: "部分图表无法渲染，已使用表格展示"
```

### 任务清单

**前置准备**:

- [ ] 确认2.0基线文件路径存在且可读
- [ ] 确认3.0对比文件路径存在且可读
- [ ] 准备Python环境 (pandas, openpyxl, datetime)
- [ ] 准备输出目录结构

**数据采集与对齐** (智能体: E4 + F3 + F5):

- [ ] 读取2.0基线Excel文件
- [ ] 分析2.0数据结构 (列名、数据类型、样本数据)
- [ ] 生成2.0标准字段定义表
- [ ] 读取3.0对比Excel文件
- [ ] 分析3.0数据结构
- [ ] 建立3.0到2.0的字段映射关系
- [ ] 应用映射规则，对齐3.0数据到2.0标准
- [ ] 验证对齐后的数据完整性

**环比分析计算** (智能体: G1):

- [ ] 计算维度1-客单价的环比 (2.0基线、3.0对比、增长率、增长额)
- [ ] 计算维度2-客流量的环比
- [ ] 计算维度3-老产品销量/销售额的环比
- [ ] 计算维度4-新产品销量/销售额的环比
- [ ] 计算维度5-人效的环比
- [ ] 计算维度6-毛利率的环比
- [ ] 计算维度7-翻座率的环比
- [ ] 计算维度8-营业额的环比
- [ ] 记录所有分母为0的情况

**时段细分分析** (智能体: G1):

- [ ] 提取时间字段，验证格式
- [ ] 应用时段分类规则 (早餐/午餐/晚餐/其他)
- [ ] 按时段拆解维度1-客单价 (4个时段 × 2个版本 = 8组数据)
- [ ] 按时段拆解维度2-客流量
- [ ] 按时段拆解维度6-毛利率
- [ ] 按时段拆解维度8-营业额
- [ ] 计算16组时段数据的环比
- [ ] 记录时间字段解析失败的情况

**数据完整性审查** (智能体: E4):

- [ ] 检查8个维度的数据完整性
- [ ] 检查16组时段数据的完整性
- [ ] 生成缺失数据清单 (维度/时段/字段)
- [ ] 生成异常数据清单 (异常值/计算失败)
- [ ] 生成补足建议清单:
  - [ ] 明确缺失的维度/时段
  - [ ] 建议的数据来源
  - [ ] 补充优先级评估
- [ ] 生成数据完整性报告

**HTML可视化开发** (智能体: F1 + F2 + X4):

- [ ] 设计HTML页面结构 (Header, Overview, Details, Supplements)
- [ ] 实现Glassmorphism样式 (CSS毛玻璃效果)
- [ ] 实现响应式布局 (Desktop & Tablet)
- [ ] 创建8维度环比对比图表 (Chart.js柱状图)
- [ ] 创建时段细分折线图 (4维度 × 4时段)
- [ ] 展示数据完整性状态 (✅完整 / ❌缺失 / ⚠️异常)
- [ ] 独立区域展示补足建议
- [ ] 添加数据标注说明 (计算公式、数据来源、更新时间)
- [ ] 浏览器测试 (Chrome, Safari, Edge)

**成果交付** (智能体: F1):

- [ ] 生成HTML报告文件
- [ ] 打开HTML并生成高清截图
- [ ] 整理输出目录:
  - [ ] report.html
  - [ ] report.png
  - [ ] data_integrity_report.md
  - [ ] supplement_suggestions.md
  - [ ] alignment_log.json
- [ ] 验证所有交付物完整

---

## ✅ 验证门控

### 门控1: 数据读取验证

```bash
# 验证2.0基线文件成功读取
python3 << 'EOF'
import pandas as pd
df = pd.read_excel('input/情报组/【2.0 VS 3.0】产品销售对比/客单价.xlsx')
assert len(df) > 0, "2.0基线文件为空"
assert len(df.columns) >= 8, "2.0基线文件字段数不足"
print(f"✅ 2.0基线文件读取成功: {len(df)}行 × {len(df.columns)}列")
EOF

# 验证3.0对比文件成功读取
python3 << 'EOF'
import pandas as pd
df = pd.read_excel('input/情报组/【2.0 VS 3.0】产品销售对比/吼巷_营业概览_20251027_0143_a899380r_1761554593716.xlsx')
assert len(df) > 0, "3.0对比文件为空"
assert len(df.columns) >= 8, "3.0对比文件字段数不足"
print(f"✅ 3.0对比文件读取成功: {len(df)}行 × {len(df.columns)}列")
EOF
```

**通过标准**: 两个Excel文件均成功读取，行数>0，列数≥8

### 门控2: 数据对齐验证

```bash
# 验证3.0数据成功对齐到2.0标准
python3 << 'EOF'
import pandas as pd
df_2_0 = pd.read_excel('input/情报组/【2.0 VS 3.0】产品销售对比/客单价.xlsx')
df_3_0_aligned = pd.read_excel('[对齐后的3.0数据文件路径]')  # 需替换为实际路径

# 验证列名一致
cols_2_0 = set(df_2_0.columns)
cols_3_0 = set(df_3_0_aligned.columns)
assert cols_2_0 == cols_3_0, f"列名不一致: {cols_2_0 ^ cols_3_0}"

# 验证数据类型一致
for col in df_2_0.columns:
    assert df_2_0[col].dtype == df_3_0_aligned[col].dtype, f"字段 {col} 数据类型不一致"

print(f"✅ 数据对齐验证通过: 列名一致，数据类型匹配")
EOF
```

**通过标准**: 3.0数据列名与2.0完全一致，数据类型匹配

### 门控3: 环比计算验证

```bash
# 验证8个维度的环比计算完成
python3 << 'EOF'
import json

with open('output/情报组/2.0-vs-3.0-comparison-[timestamp]/alignment_log.json', 'r') as f:
    results = json.load(f)

dimensions = ['客单价', '客流量', '老产品销量/销售额', '新产品销量/销售额',
              '人效', '毛利率', '翻座率', '营业额']

for dim in dimensions:
    assert dim in results['环比分析'], f"缺失维度: {dim}"
    data = results['环比分析'][dim]
    assert '2.0基线' in data, f"{dim} 缺失2.0基线"
    assert '3.0对比' in data, f"{dim} 缺失3.0对比"
    assert '增长率' in data or data.get('备注') == 'N/A', f"{dim} 缺失增长率"

print(f"✅ 8个维度环比计算验证通过")
EOF
```

**通过标准**: 8个维度均有环比结果，分母为0情况已标记"N/A"

### 门控4: 时段拆解验证

```bash
# 验证4个维度的时段细分完成
python3 << 'EOF'
import json

with open('output/情报组/2.0-vs-3.0-comparison-[timestamp]/alignment_log.json', 'r') as f:
    results = json.load(f)

dimensions = ['客单价', '客流量', '毛利率', '营业额']
time_periods = ['早餐时段', '午餐高峰', '晚餐高峰', '其他时段']

for dim in dimensions:
    assert dim in results['时段分析'], f"缺失维度: {dim}"
    for period in time_periods:
        assert period in results['时段分析'][dim], f"{dim} 缺失时段: {period}"

print(f"✅ 4个维度 × 4个时段 = 16组数据验证通过")
EOF
```

**通过标准**: 4个维度 × 4个时段 = 16组数据均完成，时段分类正确

### 门控5: 数据完整性验证

```bash
# 验证数据完整性报告已生成
test -f output/情报组/2.0-vs-3.0-comparison-*/data_integrity_report.md && \
test -f output/情报组/2.0-vs-3.0-comparison-*/supplement_suggestions.md && \
echo "✅ 数据完整性报告已生成"

# 验证缺失数据已标记
grep -q "数据缺失" output/情报组/2.0-vs-3.0-comparison-*/data_integrity_report.md || \
grep -q "数据完整" output/情报组/2.0-vs-3.0-comparison-*/data_integrity_report.md && \
echo "✅ 缺失数据检查完成"

# 验证补足建议已提出
grep -q "补充建议" output/情报组/2.0-vs-3.0-comparison-*/supplement_suggestions.md && \
echo "✅ 补足建议已提出"
```

**通过标准**:

- 数据完整性报告文件存在
- 缺失数据已明确标记
- 补足建议清单已生成

### 门控6: HTML可视化验证

```bash
# 验证HTML文件已生成且可正常打开
test -f output/情报组/2.0-vs-3.0-comparison-*/report.html && \
echo "✅ HTML报告文件已生成"

# 验证HTML包含必要元素
grep -q "客单价" output/情报组/2.0-vs-3.0-comparison-*/report.html && \
grep -q "Glassmorphism" output/情报组/2.0-vs-3.0-comparison-*/report.html && \
grep -q "chart" output/情报组/2.0-vs-3.0-comparison-*/report.html && \
echo "✅ HTML内容验证通过"

# 验证截图已生成
test -f output/情报组/2.0-vs-3.0-comparison-*/report.png && \
echo "✅ HTML截图已生成"
```

**通过标准**:

- HTML文件存在且包含必要元素
- Glassmorphism样式已应用
- 图表正确渲染
- 截图文件已生成

### 门控7: 交付物完整性验证

```bash
# 验证所有交付物完整
OUTPUT_DIR="output/情报组/2.0-vs-3.0-comparison-*"

test -f $OUTPUT_DIR/report.html && \
test -f $OUTPUT_DIR/report.png && \
test -f $OUTPUT_DIR/data_integrity_report.md && \
test -f $OUTPUT_DIR/supplement_suggestions.md && \
test -f $OUTPUT_DIR/alignment_log.json && \
echo "✅ 交付物完整性验证通过 (5个文件齐全)"
```

**通过标准**: 5个交付物文件全部存在

---

## 📈 质量标准

### 自评得分: **9/10**

### 评分理由

**优势** (9分):

1. ✅ **需求理解充分** (2分):

   - 明确8个分析维度和4个时段拆解要求
   - 理解环比分析的业务含义
   - 清楚投资者仪表板的呈现目标
2. ✅ **技术方案成熟** (2分):

   - pandas + openpyxl处理Excel是业界标准
   - Glassmorphism设计规范明确
   - Chart.js图表库成熟可靠
3. ✅ **数据完整性保障** (2分):

   - 明确"不得臆造数据"原则
   - 建立缺失数据标记机制
   - 提供补足建议生成流程
4. ✅ **智能体协作清晰** (1分):

   - 采用智能体自动匹配模式
   - 明确各阶段对应的智能体
   - 跨组协作场景完整
5. ✅ **验证门控完备** (1分):

   - 7个门控覆盖全流程
   - 所有门控可AI自动执行
   - 通过标准明确可验证
6. ✅ **错误处理全面** (1分):

   - 定义6种错误类型
   - 每种错误有明确处理策略
   - 包含用户提示和日志记录

**改进空间** (-1分):

1. ⚠️ **字段映射规则未详细定义**:

   - 虽然提到"建立字段映射关系"，但没有提供具体的映射规则示例
   - 如果3.0字段命名完全不同，可能需要人工介入确认映射
2. ⚠️ **时间字段格式假设**:

   - 假设时间字段可被 `pd.to_datetime()`解析
   - 实际可能需要针对具体格式编写解析逻辑

### 实施信心评估

**一次性实现成功的信心等级**: **90%**

**信心依据**:

- ✅ 技术栈成熟 (pandas处理Excel, Chart.js绘图)
- ✅ 错误处理完善 (6种错误类型全覆盖)
- ✅ 验证门控可执行 (7个bash脚本验证)
- ✅ 智能体协作明确 (各阶段匹配清晰)
- ⚠️ 风险点: 字段映射可能需要人工确认 (-10%)

### 后续实施建议

1. **优先执行门控1**: 先验证两个Excel文件可成功读取，如有权限或格式问题立即修复
2. **检查字段映射**: 在阶段2完成后，人工确认字段映射关系是否合理
3. **渐进式验证**: 每完成一个阶段立即执行对应门控，不要累积到最后验证
4. **保留原始数据**: 所有数据转换和对齐过程保留日志，便于追溯问题

---

## 📝 PRP元数据

```yaml
PRP元信息:
  文档名称: 2.0 vs 3.0门店升级效果对比分析
  版本号: 1.0.0
  创建时间: 2025-10-27
  作者: ZTL数智化作战中心
  质量评分: 9/10
  预计工期: 4-6小时 (视数据复杂度)
  适用场景: 餐饮门店升级效果评估、投资决策数据支持

前置依赖:
  - Python 3.8+
  - pandas ≥ 1.3.0
  - openpyxl ≥ 3.0.0
  - Chart.js ≥ 3.0.0

输入文件:
  - input/情报组/【2.0 VS 3.0】产品销售对比/客单价.xlsx
  - input/情报组/【2.0 VS 3.0】产品销售对比/吼巷_营业概览_20251027_0143_a899380r_1761554593716.xlsx

输出文件:
  - output/情报组/2.0-vs-3.0-comparison/report.html
  - output/情报组/2.0-vs-3.0-comparison/report.png
  - output/情报组/2.0-vs-3.0-comparison/data_integrity_report.md
  - output/情报组/2.0-vs-3.0-comparison/supplement_suggestions.md
  - output/情报组/2.0-vs-3.0-comparison/alignment_log.json

协作智能体:
  - E2-Chrome网页采集 或 F3-数据库开发 (数据采集)
  - E4-深度情报分析 (数据解析、完整性审查)
  - F5-后端开发 (数据对齐)
  - G1-经营分析优化师 (环比分析、时段拆解)
  - F1-前端开发 (HTML可视化)
  - F2-组件开发 (Glassmorphism样式)
  - X4-图文排版师 (视觉呈现)
```

---

**PRP文档结束** 🚀
