# Phase 3 - 3D生成技术调研报告

> **项目**: 筹建组Z3智能体重构
> **日期**: 2025-10-28
> **状态**: 技术选型阶段

---

## 📋 调研目标

将Z3从"传统BIM建模师"(使用Revit/Navisworks手动建模)转变为"AIGC 3D生成助手"(调用AI 3D生成API)。

### 核心需求

1. **输入**: 空间设计效果图(PNG)或文本描述
2. **输出**: 3D模型文件(OBJ, GLB, FBX等)
3. **质量**: 适合餐饮空间可视化展示
4. **速度**: 10分钟内完成生成
5. **成本**: 合理的API调用成本

---

## 🔬 技术路线对比

### 路线1: Text-to-3D (文本生成3D)

**原理**: 直接从文本描述生成3D模型

**优点**:
- ✅ 流程简单,一步到位
- ✅ 不依赖其他Agent的输出

**缺点**:
- ❌ 技术不成熟,质量不稳定
- ❌ 难以精确控制细节
- ❌ 空间设计场景复杂度高,效果可能不佳

**适用场景**: 简单物体建模(家具、装饰品)

---

### 路线2: Image-to-3D (图像生成3D) ✅ 推荐

**原理**: 从2D图像(效果图)重建3D模型

**优点**:
- ✅ **技术成熟度高**: TripoSR, Meshy等已商用
- ✅ **可利用Z2成果**: 基于Z2生成的高质量效果图
- ✅ **质量可控**: 效果图质量直接影响3D质量
- ✅ **适合空间场景**: 专门针对场景重建优化

**缺点**:
- ⚠️ 依赖Z2的输出质量
- ⚠️ 需要多视角融合(单张图重建有限)

**适用场景**: 餐饮空间3D场景重建 ⭐

---

## 🛠️ 技术选项评估

### 选项A: TripoSR (开源) ⭐⭐⭐⭐⭐

**开发者**: Stability AI + Tripo AI

**技术规格**:
- 模型: 基于Transformer的图像到3D重建
- 输入: 单张或多张PNG/JPG图像
- 输出: Mesh(OBJ, GLB, FBX)
- 生成时间: 10-30秒
- 分辨率: 支持高分辨率网格

**API可用性**:
- ✅ **开源模型**: MIT许可证,可本地部署
- ✅ **商业API**: 通过Replicate/HuggingFace提供API
- ✅ **成本**: 开源免费,API约$0.01-0.05/次

**质量评估**:
- 几何准确性: ⭐⭐⭐⭐ (4/5)
- 纹理质量: ⭐⭐⭐⭐ (4/5)
- 场景完整性: ⭐⭐⭐⭐ (4/5)
- 商用成熟度: ⭐⭐⭐⭐⭐ (5/5)

**示例应用**:
```python
# TripoSR API调用示例
import replicate

output = replicate.run(
    "stability-ai/triposr:latest",
    input={
        "image": open("entrance-new-chinese.png", "rb"),
        "format": "glb",
        "resolution": 1024
    }
)

# 输出: entrance-3d-model.glb
```

**适用场景**:
- ✅ 空间场景重建
- ✅ 家具物体建模
- ✅ 快速原型制作

**推荐指数**: ⭐⭐⭐⭐⭐ (强烈推荐)

---

### 选项B: Meshy AI ⭐⭐⭐⭐

**开发者**: Meshy (专业3D生成平台)

**技术规格**:
- 支持: Text-to-3D, Image-to-3D
- 输入: 文本提示词 或 图像文件
- 输出: GLB, FBX, OBJ, USDZ
- 生成时间: 2-5分钟
- 特性: 自动纹理生成、PBR材质

**API可用性**:
- ✅ **商业API**: 官方REST API
- ✅ **Python SDK**: 官方SDK支持
- ⚠️ **成本**: 约$0.10-0.30/模型(较贵)

**质量评估**:
- 几何准确性: ⭐⭐⭐⭐⭐ (5/5)
- 纹理质量: ⭐⭐⭐⭐⭐ (5/5)
- 场景完整性: ⭐⭐⭐⭐ (4/5)
- 商用成熟度: ⭐⭐⭐⭐⭐ (5/5)

**示例应用**:
```python
# Meshy API调用示例
from meshy_sdk import MeshyClient

client = MeshyClient(api_key="your-api-key")

# Image-to-3D
task = client.create_image_to_3d_task(
    image_path="entrance-new-chinese.png",
    enable_pbr=True,
    format="glb"
)

# 等待完成
result = client.wait_for_completion(task.id)
model_url = result.model_url
```

**适用场景**:
- ✅ 高质量商业项目
- ✅ 需要PBR材质的场景
- ⚠️ 预算充足的项目

**推荐指数**: ⭐⭐⭐⭐ (质量优秀但成本较高)

---

### 选项C: Luma AI Genie ⭐⭐⭐

**开发者**: Luma AI

**技术规格**:
- 支持: Text-to-3D, Image-to-3D
- 输入: 文本或图像
- 输出: OBJ, GLB
- 生成时间: 1-3分钟
- 特性: 高质量几何,自动优化

**API可用性**:
- ⚠️ **有限API**: 主要通过Web界面
- ❌ **无官方SDK**: 需要逆向工程或等待官方开放
- ⚠️ **成本**: 订阅制,不适合按需调用

**质量评估**:
- 几何准确性: ⭐⭐⭐⭐⭐ (5/5)
- 纹理质量: ⭐⭐⭐⭐ (4/5)
- 场景完整性: ⭐⭐⭐ (3/5)
- 商用成熟度: ⭐⭐⭐ (3/5)

**适用场景**:
- ⚠️ 目前不推荐用于自动化流程
- 🔜 等待官方API开放

**推荐指数**: ⭐⭐⭐ (质量高但API可用性差)

---

### 选项D: Wonder3D ⭐⭐⭐

**开发者**: 研究项目(港科大、清华)

**技术规格**:
- 支持: Single-Image-to-3D
- 输入: 单张图像
- 输出: Mesh + Texture
- 生成时间: 10-20秒
- 特性: 一致性多视角生成

**API可用性**:
- ✅ **开源代码**: GitHub公开
- ⚠️ **无官方API**: 需要自行部署
- ✅ **成本**: 开源免费

**质量评估**:
- 几何准确性: ⭐⭐⭐⭐ (4/5)
- 纹理质量: ⭐⭐⭐ (3/5)
- 场景完整性: ⭐⭐⭐ (3/5)
- 商用成熟度: ⭐⭐ (2/5)

**适用场景**:
- ⚠️ 需要自行部署和维护
- 🔬 适合研究和实验

**推荐指数**: ⭐⭐⭐ (技术先进但部署复杂)

---

## 🎯 推荐方案

### 最佳选择: TripoSR (via Replicate API)

**理由**:

1. **成熟度高**: Stability AI背书,商业级质量
2. **成本合理**: $0.01-0.05/模型,远低于Meshy
3. **API友好**: Replicate平台提供稳定API
4. **开源保底**: 如果API不可用,可以本地部署
5. **质量稳定**: 4/5星质量,满足餐饮空间需求

**技术架构**:

```
Z2效果图 (PNG) → TripoSR API → 3D模型 (GLB/OBJ) → 导出供查看
      ↓                           ↓
  多视角图像             可选: 纹理优化
      ↓                           ↓
  批量处理              格式转换(FBX, USDZ)
```

---

## 📊 成本估算

### 单个项目成本 (300㎡火锅店)

**场景数量**: 6个空间场景 (入口、主用餐区、VIP包间、等位区、洗手间、收银区)

**每个场景**: 1张效果图 → 1个3D模型

**TripoSR成本**:
- 单模型: $0.01-0.05
- 总计: $0.06 - $0.30

**Meshy成本** (对比):
- 单模型: $0.10-0.30
- 总计: $0.60 - $1.80

**节省**: 使用TripoSR可节省 80-83% 成本

---

## 🔄 工作流程设计

### Z2 → Z3 协作流程

```
Step 1: Z2生成效果图
  - 输入: 设计配置JSON
  - 输出: 6个场景的效果图PNG (1024x1024)

Step 2: Z3生成3D模型
  - 输入: Z2的效果图
  - 输出: 6个场景的3D模型GLB/OBJ

Step 3: (可选) 模型优化
  - 纹理增强
  - 网格简化
  - 格式转换

Step 4: 交付
  - 3D模型文件包
  - 在线3D查看器
  - 导出到Unity/Unreal(如需要)
```

### 技术栈

| 层级 | 组件 | 技术 |
|------|------|------|
| 规范层 | Z3 Agent定义 | Markdown文档 |
| 计划层 | 3D生成配置 | JSON配置文件 |
| 执行层 | API客户端 | Python + Replicate SDK |
| 存储层 | 3D模型文件 | GLB/OBJ/FBX格式 |

---

## 🚨 技术风险

### 风险1: 单视角重建质量

**问题**: 单张2D图像重建3D可能存在遮挡和模糊区域

**解决方案**:
1. **多视角生成**: 让Z2生成同一场景的多角度视图
2. **深度图辅助**: 使用Depth-Anything生成深度图辅助重建
3. **后期优化**: 人工或AI辅助修复模型缺陷

### 风险2: API可用性

**问题**: Replicate API可能不稳定或限流

**解决方案**:
1. **本地部署备选**: TripoSR开源,可本地部署
2. **多API切换**: 准备Meshy作为备用API
3. **重试机制**: 实现自动重试和错误处理

### 风险3: 成本控制

**问题**: 大量生成可能超出预算

**解决方案**:
1. **成本预估**: 生成前计算预估成本并请求确认
2. **配额管理**: 设置每日/每月生成配额
3. **缓存机制**: 相似场景复用已生成模型

---

## 📝 实施计划

### Day 1: 技术调研 ✅
- 完成3D生成技术选型
- 确定TripoSR为主方案

### Day 2: Z3 Agent重写
- 将Z3定位改为"3D生成AIGC助手"
- 设计6-step工作流程
- 定义Prompt优化策略

### Day 3: 技能包创建
- 创建canvas-design-3d-generation技能包
- 实现TripoSR API客户端
- 配置文件模板

### Day 4: 配置和示例
- 创建完整的配置模板
- 火锅店300㎡示例
- 多视角生成策略

### Day 5: 集成测试
- 目录结构测试
- API调用测试
- 端到端流程测试

---

## 🎉 预期成果

### Z3能力对比

| 能力维度 | 传统BIM建模师 | Z3-3D生成AIGC助手 |
|---------|--------------|------------------|
| **建模方式** | Revit手动建模 | AIGC自动生成 |
| **周期** | 2-3周 | 1-2小时 |
| **成本** | ¥10,000-30,000 | $0.06-0.30 |
| **技能要求** | 专业BIM工程师 | Prompt工程 |
| **输出格式** | RVT, NWF | GLB, OBJ, FBX |
| **适用场景** | 施工图、BOM | 可视化展示 |

### 价值主张

1. **效率提升**: 从2-3周 → 1-2小时 (200倍提升)
2. **成本降低**: 从¥10,000+ → $0.30 (99.99%降低)
3. **流程优化**: 无缝衔接Z2效果图生成
4. **质量可控**: 基于高质量效果图重建

---

## 🔗 参考资源

### 技术文档
- [TripoSR GitHub](https://github.com/VAST-AI-Research/TripoSR)
- [Replicate API](https://replicate.com/stability-ai/triposr)
- [Meshy Documentation](https://docs.meshy.ai/)

### 研究论文
- TripoSR: Fast 3D Object Reconstruction from a Single Image
- Wonder3D: Single Image to 3D using Cross-Domain Diffusion

---

**报告生成**: 2025-10-28
**报告作者**: Claude Code (Sonnet 4.5)
**决策**: 采用TripoSR (via Replicate API) 作为Z3的3D生成引擎
**下一步**: 重写Z3 Agent定义
