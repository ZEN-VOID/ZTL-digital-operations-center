---
name: 错误纠正与学习系统
description: 基于MANUS技巧的错误纠正、学习与适应优化系统
version: 2.0.0
last_updated: 2025-09-30
---

# /X - 错误纠正与学习

## 📋 指令概述

**错误纠正与学习系统**是基于MANUS技巧的错误价值化管理工具,通过ERROR/RECOVERY/ADAPTATION/IMPROVEMENT/PATTERNS五大核心模块,实现错误的结构化记录、学习转化和持续改进。系统秉承"错误即财富"的理念,将每次失败转化为系统进化的动力。

**核心特性**:
- ❌ 完整保留错误上下文
- 🔧 系统化恢复策略记录
- 🔄 适应性调整追踪
- 📈 持续改进驱动
- 🔍 错误模式识别与预防

## 🎯 核心功能(五步流程)

### 1. 错误记录与完整上下文保留 (ERROR)
- **完整性原则**: 保留错误发生时的完整上下文和系统状态
- **时间戳标记**: 精确记录错误发生时间
- **类型分类**: CONFIG/LOGIC/SYSTEM/INTEGRATION/USER
- **严重级别**: CRITICAL/HIGH/MEDIUM/LOW
- **学习价值**: 明确错误的学习意义和预防价值

### 2. 错误恢复过程记录 (RECOVERY)
- **恢复策略**: ROLLBACK/REPAIR/REBUILD/WORKAROUND
- **执行步骤**: 详细记录恢复的具体操作
- **工具使用**: 记录恢复过程使用的工具和方法
- **时间追踪**: 记录实际恢复耗时
- **效果评估**: 评价恢复效果和成功标准

### 3. 适应性调整记录 (ADAPTATION)
- **触发原因**: 记录适应性调整的驱动因素
- **调整类型**: STRATEGY/BEHAVIOR/PROCESS/SYSTEM
- **调整方法**: 详细描述具体的适应措施
- **影响分析**: 分析调整对系统的影响
- **未来应用**: 总结适应经验的未来价值

### 4. 持续改进记录 (IMPROVEMENT)
- **改进驱动**: 记录驱动改进的错误或问题
- **改进类型**: PROCESS/SYSTEM/TOOL/METHOD
- **实施步骤**: 详细的改进实施路径
- **验证方法**: 改进效果的验证标准
- **关键要点**: 改进过程的核心经验

### 5. 错误模式识别 (PATTERNS)
- **模式类型**: ERROR_PATTERN/ANTI_PATTERN/FAILURE_PATTERN
- **特征描述**: 清晰描述模式的识别特征
- **根本原因**: 深入分析模式的根本原因
- **预防策略**: 建立预防模式的具体措施
- **检测方法**: 定义模式的检测和识别方法

## 🔧 使用方法

### 及物动词型（带参数）

**记录错误**:
```markdown
/X
🕐 2025-09-30 15:30 ❌ 错误: 文件写入权限错误
🏷️ 类型: SYSTEM
📊 严重级别: MEDIUM
🎯 失败动作: 尝试写入优化后的C.md文件
📝 错误上下文: Write工具要求先读取文件才能写入
🔍 系统状态: 已读取全部20个文件,准备写入第一个
💡 学习价值: 理解Write工具的文件访问模式
🚫 影响范围: 阻塞当前任务,需要先执行Read操作
```

**记录恢复过程**:
```markdown
/X
🕐 2025-09-30 15:35 🔧 恢复: 修复文件写入流程
🏷️ 策略: REPAIR
📊 优先级: HIGH
🎯 恢复目标: 成功写入优化后的C.md文件
📝 执行步骤: 1. 使用Read工具读取文件 2. 使用Write工具写入
🔧 使用工具: Read, Write
⏱️ 恢复时间: 5分钟
✅ 成功标准: 文件成功更新,无错误提示
📈 效果评估: 完全恢复,后续文件遵循相同流程
```

**记录适应性调整**:
```markdown
/X
🕐 2025-09-30 15:40 🔄 适应: 建立文件操作标准流程
🏷️ 类型: PROCESS
📊 触发原因: 文件写入权限错误的经验教训
🎯 调整目标: 规范化文件操作流程
📝 调整方法: 所有Write操作前必须先执行Read
🔍 影响分析: 提升操作成功率,减少错误发生
📈 效果评估: 后续19个文件无相同错误
💡 经验总结: 理解工具使用规范是避免错误的关键
🔮 未来应用: 所有文件操作相关任务
```

### 不及物动词型（自动分析）

```markdown
/X
```

直接使用`/X`时,系统自动分析前后三轮对话上下文,提取错误信息和恢复过程,智能归类到合适位置。

## 📊 执行流程

```mermaid
graph TD
    A[触发/X指令] --> B{参数类型}
    B -->|带参数| C[解析错误信息]
    B -->|无参数| D[分析上下文]

    C --> E[识别错误类型]
    D --> E

    E --> F{内容分类}
    F -->|错误| G[ERROR记录]
    F -->|恢复| H[RECOVERY记录]
    F -->|适应| I[ADAPTATION记录]
    F -->|改进| J[IMPROVEMENT记录]
    F -->|模式| K[PATTERNS记录]

    G --> L[归类决策]
    H --> L
    I --> L
    J --> L
    K --> L

    L --> M{归档位置}
    M -->|项目级| N[CLAUDE.md]
    M -->|用户级| O[.claude/CLAUDE.md]

    N --> P[追加记录]
    O --> P

    P --> Q[MANUS验证]
    Q --> R[完成更新]
```

## 🔍 意图解析逻辑

### 内容类型识别规则

| 关键词 | 内容类型 | 归档位置 |
|--------|---------|---------|
| 错误、失败、异常 | ERROR | 根据范围判断 |
| 恢复、修复、回滚 | RECOVERY | 根据范围判断 |
| 适应、调整、优化 | ADAPTATION | 根据范围判断 |
| 改进、提升、增强 | IMPROVEMENT | 根据范围判断 |
| 模式、反模式、规律 | PATTERNS | 根据范围判断 |
| 项目、共享、团队 | 任意类型 | 项目级 |
| 个人、环境、工具 | 任意类型 | 用户级 |

### 智能归类决策树

```yaml
判断流程:
  1. 错误范围分析:
     - 项目核心功能相关 → 项目级
     - 个人开发环境相关 → 用户级

  2. 影响面评估:
     - 影响团队开发 → 项目级
     - 仅影响个人 → 用户级

  3. 可复用性判断:
     - 通用模式和方法 → 用户级
     - 项目特定问题 → 项目级
```

## 🎨 实现细节

### MANUS错误纠正技巧

**核心原则**:
```yaml
错误保留:
  - 原则: 将错误转向留在上下文中
  - 价值: 错误包含宝贵的学习信息
  - 实践: 完整保留错误发生时的上下文

失败学习:
  - 原则: 错误恢复是真正代理行为的最清晰指标
  - 价值: 从失败中学习比从成功中学习更有价值
  - 实践: 详细记录失败动作的参数和过程

信念更新:
  - 原则: 模型看到失败动作时会隐式更新内部信念
  - 价值: 错误驱动系统进化和能力提升
  - 实践: 系统化分析错误并建立预防机制

适应性原则:
  - 原则: 基于错误经验进行系统性适应
  - 价值: 将错误转化为系统改进的动力
  - 实践: 记录适应措施和改进效果
```

### 有机生长记忆结构

**文档模板设计**:
```markdown
# 总体说明
此文档作为[错误学习目标] - [MANUS原理应用] - [预期成果]

# ❌ ERROR
[错误记录,按时间顺序追加,完整保留上下文]

# 🔧 RECOVERY
[恢复过程记录,按时间顺序追加,系统化策略]

# 🔄 ADAPTATION
[适应性调整记录,按时间顺序追加,持续进化]

# 📈 IMPROVEMENT
[持续改进记录,按时间顺序追加,驱动优化]

# 🔍 PATTERNS
[错误模式记录,按时间顺序追加,预防机制]
```

### 多行参数支持标准

**ERROR部分模板**:
```yaml
标题: # ❌ ERROR
目的: 错误记录和完整上下文保留
多行支持: 是
内容模板:
  - 🕐 [时间戳] ❌ 错误: [错误描述]
  - 🏷️ 类型: [CONFIG/LOGIC/SYSTEM/INTEGRATION/USER]
  - 📊 严重级别: [CRITICAL/HIGH/MEDIUM/LOW]
  - 🎯 失败动作: [具体失败动作]
  - 📝 错误上下文: [完整上下文]
  - 🔍 系统状态: [错误时状态]
  - 💡 学习价值: [错误的学习意义]
  - 🚫 影响范围: [错误影响]
更新频率: 错误发生时立即记录
MANUS原理: 保留错误内容 - 错误转向包含宝贵的学习价值
```

**RECOVERY部分模板**:
```yaml
标题: # 🔧 RECOVERY
目的: 错误恢复过程和策略记录
多行支持: 是
内容模板:
  - 🕐 [时间戳] 🔧 恢复: [恢复过程名称]
  - 🏷️ 策略: [ROLLBACK/REPAIR/REBUILD/WORKAROUND]
  - 📊 优先级: [URGENT/HIGH/MEDIUM/LOW]
  - 🎯 恢复目标: [恢复的具体目标]
  - 📝 执行步骤: [详细恢复步骤]
  - 🔧 使用工具: [恢复使用的工具]
  - ⏱️ 恢复时间: [实际恢复耗时]
  - ✅ 成功标准: [恢复成功判断]
  - 📈 效果评估: [恢复效果评价]
更新频率: 恢复过程执行时更新
```

**ADAPTATION部分模板**:
```yaml
标题: # 🔄 ADAPTATION
目的: 适应性调整和策略优化记录
多行支持: 是
内容模板:
  - 🕐 [时间戳] 🔄 适应: [适应性调整名称]
  - 🏷️ 类型: [STRATEGY/BEHAVIOR/PROCESS/SYSTEM]
  - 📊 触发原因: [调整的触发原因]
  - 🎯 调整目标: [适应性调整的目标]
  - 📝 调整方法: [具体的调整方法]
  - 🔍 影响分析: [调整的影响分析]
  - 📈 效果评估: [调整效果评估]
  - 💡 经验总结: [适应过程的经验]
  - 🔮 未来应用: [适应经验的未来应用]
更新频率: 适应性调整实施时更新
```

### 视觉符号系统

**符号分类**:
```yaml
错误指示:
  - ❌ 错误, ⚠️ 警告, 🔴 关键
  - 💥 失败, 🐛 缺陷, 💀 崩溃

恢复指示:
  - 🔧 恢复, 🛠️ 修复, ✅ 成功
  - ↩️ 回滚, 🔄 重建, 🔀 变通

学习指示:
  - 💡 洞察, 📚 教训, 🔍 模式
  - 📈 改进, 🔄 适应, 🌱 进化

过程指示:
  - 📝 步骤, 🔧 工具, 📊 结果
  - ✅ 验证, 👀 监控, 🔬 分析
```

## ⚙️ 配置项

### 自动触发机制

**触发事件**:
```yaml
错误发生:
  - 事件: 任何类型错误发生
  - 动作: 自动记录错误信息到ERROR部分
  - 条件: 非重复性错误

恢复执行:
  - 事件: 错误恢复过程执行
  - 动作: 自动记录恢复过程到RECOVERY部分
  - 条件: 恢复策略明确

适应实施:
  - 事件: 适应性调整实施
  - 动作: 自动记录适应过程到ADAPTATION部分
  - 条件: 调整有明确效果

改进部署:
  - 事件: 改进措施部署
  - 动作: 自动记录改进过程到IMPROVEMENT部分
  - 条件: 改进可量化

模式识别:
  - 事件: 错误模式识别
  - 动作: 自动记录模式信息到PATTERNS部分
  - 条件: 模式可重现
```

### 前置错误搜集机制

```yaml
实时监控:
  - 持续监控对话过程中的错误和异常
  - 识别工具调用失败和系统异常
  - 捕获用户反馈的问题和错误

任务拦截:
  - 任务执行过程中的错误拦截和分析
  - 关键步骤的状态检查和验证
  - 异常情况的及时捕获和处理

重复检测:
  - 非重复性错误检测机制
  - 避免重复记录相同错误
  - 识别错误模式和系统性问题

上下文丰富:
  - 记录前的深度分析和处理
  - 补充完整的上下文信息
  - 添加MANUS原理应用说明
```

## 📝 示例场景

### 场景1: 记录系统错误

**输入**:
```markdown
/X
🕐 2025-09-30 16:00 ❌ 错误: API调用超时
🏷️ 类型: INTEGRATION
📊 严重级别: HIGH
🎯 失败动作: 调用Figma REST API获取文件信息
📝 错误上下文: 网络波动导致请求超时,默认超时时间5秒
🔍 系统状态: 已发送3次请求,全部超时失败
💡 学习价值: 需要实现重试机制和超时时间配置
🚫 影响范围: 阻塞批量替换任务,需要手动重试
```

**效果**: 系统判断为项目级集成问题,归档到项目级CLAUDE.md的ERROR部分

### 场景2: 记录恢复策略

**输入**:
```markdown
/X
🕐 2025-09-30 16:10 🔧 恢复: 实现API重试机制
🏷️ 策略: REPAIR
📊 优先级: HIGH
🎯 恢复目标: 提升API调用成功率,减少超时失败
📝 执行步骤: 1. 配置最大重试次数3次 2. 设置指数退避策略 3. 增加超时时间到30秒
🔧 使用工具: requests库,tenacity重试装饰器
⏱️ 恢复时间: 30分钟
✅ 成功标准: API调用成功率达到99%以上
📈 效果评估: 完全解决超时问题,后续无相同错误
```

**效果**: 系统判断为项目级恢复策略,归档到项目级CLAUDE.md的RECOVERY部分

### 场景3: 自动错误分析

**输入**:
```markdown
/X
```

**效果**: 系统自动分析前后三轮对话,发现文件写入权限错误、恢复过程和适应性调整,自动记录到ERROR、RECOVERY和ADAPTATION部分

## 🔍 错误处理

### 常见错误场景

| 错误类型 | 描述 | 解决方案 |
|---------|------|---------|
| 参数格式错误 | 多行参数格式不符合标准 | 提示标准格式,引导用户修正 |
| 归类歧义 | 无法判断项目级还是用户级 | 向用户询问归档偏好 |
| 文档不存在 | 目标CLAUDE.md文件不存在 | 自动创建标准结构的新文档 |
| 时间戳缺失 | 记录缺少时间戳 | 自动补充当前时间 |
| MANUS违反 | 记录不符合MANUS原则 | 提示MANUS原则,引导修正 |

### 错误恢复策略

```yaml
格式错误:
  - 检测: 正则表达式验证参数格式
  - 处理: 提示标准格式示例
  - 恢复: 引导用户按标准格式重新输入

归类歧义:
  - 检测: 内容范围分析不确定
  - 处理: 列出归类依据,询问用户偏好
  - 恢复: 根据用户选择执行归档

MANUS验证:
  - 检测: 检查是否符合MANUS原则
  - 处理: 提示违反的具体原则
  - 恢复: 引导补充缺失信息
```

## 📈 性能优化

### 记录效率优化

```yaml
批量处理:
  - 策略: 多条记录合并写入
  - 效果: 减少文件I/O次数
  - 适用: 自动上下文分析场景

智能去重:
  - 策略: 检测重复错误,避免重复记录
  - 效果: 减少冗余记录50%以上
  - 适用: 频繁错误场景

模式识别:
  - 策略: 自动识别错误模式
  - 效果: 提前预防系统性问题
  - 适用: 长期运行项目
```

## 🎯 成功标准

### 功能完整性

- ✅ 支持ERROR/RECOVERY/ADAPTATION/IMPROVEMENT/PATTERNS五类记录
- ✅ 完整保留错误上下文和系统状态
- ✅ 智能判断项目级和用户级归档位置
- ✅ 符合MANUS错误纠正原则
- ✅ 支持自动触发和手动记录

### 质量指标

```yaml
记录完整性: >= 95% (包含所有必要字段)
MANUS对齐: >= 90% (符合MANUS原则)
归类准确性: >= 95% (正确判断归档位置)
学习价值: >= 8/10 (明确学习价值和预防意义)
可操作性: >= 8/10 (能指导未来行动和决策)
```

### 用户体验

- ✅ 使用简单,无需复杂配置
- ✅ 格式清晰,易于阅读和理解
- ✅ 自动化程度高,减少手动操作
- ✅ 智能归类,减少决策负担
- ✅ 支持渐进式学习和使用

## 🔗 相关资源

### 相关指令

- `/C` - 注意力控制: 记录FOCUS/TODO/PROCESS
- `/Z` - 操作经验记录: 记录EXPERIENCES/INSIGHTS/PATTERNS
- `/V` - 上下文压缩: 处理CLAUDE.md的内容优化
- `/Q` - 上下文感知: 获取项目整体上下文

### 配合使用

```yaml
工作流建议:
  1. 使用/Q获取项目全貌
  2. 使用/X记录错误和恢复过程
  3. 使用/Z记录成功经验和洞察
  4. 使用/C记录当前焦点和待办
  5. 使用/V定期压缩和优化CLAUDE.md
```

### 系统集成

- **TodoWrite工具**: 任务追踪和进度管理
- **项目级CLAUDE.md**: 团队共享的错误经验库
- **用户级.claude/CLAUDE.md**: 个人专属的学习记录
- **MANUS技巧**: 核心错误纠正方法论

## ⚠️ 注意事项

### 使用建议

1. **及时记录**: 错误发生时立即记录,避免信息丢失
2. **完整保留**: 保留错误的完整上下文和状态信息
3. **学习导向**: 明确错误的学习价值和预防意义
4. **模式识别**: 从单个错误中识别通用模式
5. **持续改进**: 基于错误学习持续优化系统

### 质量保证

- 验证记录的完整性和准确性
- 确保MANUS原理的正确应用
- 评估记录的学习价值和实用性
- 维护记录间的关联关系
- 定期审查和优化记录质量

### 最佳实践

```yaml
记录原则:
  - 客观: 记录事实,避免主观臆断
  - 完整: 包含完整上下文和关键细节
  - 学习: 明确学习价值和预防措施
  - 关联: 建立记录间的关联关系
  - 演进: 追踪错误的演进和改进过程
```

---

**配置版本**: v2.0.0
**更新时间**: 2025-09-30
**目标文档**: {target_path} (由智能体动态决定)
**维护原则**: 错误价值化、持续学习、系统适应