"""
Example: Meeting Minutes Generation

This example demonstrates creating meeting minutes using the template system.
"""

import sys
from pathlib import Path

# Add skill to path
skill_path = Path(__file__).parent.parent / "scripts"
sys.path.insert(0, str(skill_path))

from word_generator import create_from_template


def create_meeting_minutes():
    """Create sample meeting minutes."""

    data = {
        "title": "æˆ˜ç•¥è§„åˆ’ä¼šè®®çºªè¦",
        "date": "2025-10-21",
        "time": "14:00-16:30",
        "location": "æ€»éƒ¨ä¼šè®®å®¤A",
        "host": "å¼ æ€»ç»ç†",
        "attendees": [
            "å¼ æ€»ç»ç†",
            "æè¿è¥æ€»ç›‘",
            "ç‹äº§å“ç»ç†",
            "èµµè¥é”€ç»ç†",
            "å­™è´¢åŠ¡ç»ç†"
        ],
        "topics": [
            {
                "topic": "Q4æˆ˜ç•¥ç›®æ ‡è®¨è®º",
                "discussion": """
å„ä½ä¸ä¼šäººå‘˜å°±Q4æˆ˜ç•¥ç›®æ ‡è¿›è¡Œäº†æ·±å…¥è®¨è®º:

1. å¼ æ€»ç»ç†æå‡ºQ4è¦å®ç°è¥ä¸šé¢600ä¸‡çš„ç›®æ ‡,åŒæ¯”å¢é•¿30%
2. æè¿è¥æ€»ç›‘åˆ†æäº†å½“å‰è¿è¥çŠ¶å†µ,è®¤ä¸ºç›®æ ‡å…·æœ‰æŒ‘æˆ˜æ€§ä½†å¯å®ç°
3. ç‹äº§å“ç»ç†å»ºè®®æ¨å‡º3æ¬¾ç§‹å†¬æ–°å“,é¢„è®¡è´¡çŒ®15%å¢é‡
4. èµµè¥é”€ç»ç†æå‡ºåŠ å¤§ä¼šå‘˜è¥é”€åŠ›åº¦,æå‡å¤è´­ç‡
5. å­™è´¢åŠ¡ç»ç†å¼ºè°ƒè¦ä¸¥æ§æˆæœ¬,ç¡®ä¿åˆ©æ¶¦ç‡ä¸ä½äº25%

ç»è®¨è®º,ä¸€è‡´é€šè¿‡Q4æˆ˜ç•¥ç›®æ ‡åŠå®æ–½æ–¹æ¡ˆã€‚
                """,
                "action_items": [
                    {
                        "task": "åˆ¶å®šè¯¦ç»†çš„Q4è¿è¥è®¡åˆ’",
                        "owner": "æè¿è¥æ€»ç›‘",
                        "deadline": "10-25"
                    },
                    {
                        "task": "å®Œæˆæ–°å“ç ”å‘å’Œä¸Šå¸‚å‡†å¤‡",
                        "owner": "ç‹äº§å“ç»ç†",
                        "deadline": "10-31"
                    },
                    {
                        "task": "ç­–åˆ’ä¼šå‘˜è¥é”€æ´»åŠ¨æ–¹æ¡ˆ",
                        "owner": "èµµè¥é”€ç»ç†",
                        "deadline": "10-28"
                    },
                    {
                        "task": "åˆ¶å®šæˆæœ¬æ§åˆ¶æªæ–½",
                        "owner": "å­™è´¢åŠ¡ç»ç†",
                        "deadline": "10-26"
                    }
                ]
            },
            {
                "topic": "æ–°åº—é€‰å€è¯„ä¼°",
                "discussion": """
è®¨è®ºäº†Dåº—å’ŒEåº—ä¸¤ä¸ªæ½œåœ¨é€‰å€æ–¹æ¡ˆ:

Dåº—æ–¹æ¡ˆ(å¸‚ä¸­å¿ƒå•†åœˆ):
- ä¼˜ç‚¹: äººæµé‡å¤§,å“ç‰Œæ›å…‰åº¦é«˜,å‘¨è¾¹æ¶ˆè´¹èƒ½åŠ›å¼º
- ç¼ºç‚¹: ç§Ÿé‡‘è¾ƒé«˜(2.5ä¸‡/æœˆ),ç«äº‰æ¿€çƒˆ
- é¢„ä¼°æœˆè¥ä¸šé¢: 50-60ä¸‡

Eåº—æ–¹æ¡ˆ(å¤§å­¦åŸå•†åœˆ):
- ä¼˜ç‚¹: ç§Ÿé‡‘é€‚ä¸­(1.5ä¸‡/æœˆ),å¹´è½»å®¢ç¾¤å¤š,æ¶ˆè´¹æ½œåŠ›å¤§
- ç¼ºç‚¹: æ¶ˆè´¹èƒ½åŠ›ç›¸å¯¹è¾ƒå¼±,å­£èŠ‚æ€§æ³¢åŠ¨å¤§
- é¢„ä¼°æœˆè¥ä¸šé¢: 35-45ä¸‡

ç»ç»¼åˆè¯„ä¼°,åˆæ­¥å€¾å‘Dåº—æ–¹æ¡ˆ,ä½†éœ€è¿›ä¸€æ­¥å¸‚åœºè°ƒç ”ã€‚
                """,
                "action_items": [
                    {
                        "task": "å®ŒæˆDåº—å’ŒEåº—è¯¦ç»†å•†åœˆåˆ†æ",
                        "owner": "æè¿è¥æ€»ç›‘",
                        "deadline": "11-05"
                    },
                    {
                        "task": "åˆ¶å®šä¸¤ä¸ªæ–¹æ¡ˆçš„è´¢åŠ¡æ¨¡å‹",
                        "owner": "å­™è´¢åŠ¡ç»ç†",
                        "deadline": "11-08"
                    },
                    {
                        "task": "ä¸æˆ¿ä¸œè¿›è¡Œç§Ÿé‡‘è°ˆåˆ¤",
                        "owner": "å¼ æ€»ç»ç†",
                        "deadline": "11-10"
                    }
                ]
            },
            {
                "topic": "ä¾›åº”é“¾ä¼˜åŒ–æ–¹æ¡ˆ",
                "discussion": """
å­™è´¢åŠ¡ç»ç†æå‡ºå½“å‰ä¾›åº”é“¾å­˜åœ¨ä»¥ä¸‹é—®é¢˜:
1. é£Ÿææˆæœ¬å æ¯”30%,ç•¥é«˜äºè¡Œä¸šå¹³å‡æ°´å¹³
2. éƒ¨åˆ†é£Ÿææµªè´¹ç‡è¾¾åˆ°8%,éœ€è¦æ”¹è¿›
3. ä¾›åº”å•†è¾ƒä¸ºåˆ†æ•£,è®®ä»·èƒ½åŠ›ä¸è¶³

æå‡ºä¼˜åŒ–æ–¹æ¡ˆ:
1. æ•´åˆä¾›åº”å•†,ä¸3-5å®¶æ ¸å¿ƒä¾›åº”å•†å»ºç«‹é•¿æœŸæˆ˜ç•¥åˆä½œ
2. å¼•å…¥æ™ºèƒ½åº“å­˜ç®¡ç†ç³»ç»Ÿ,é™ä½æŸè€—ç‡
3. å»ºç«‹ä¸­å¤®å¨æˆ¿,ç»Ÿä¸€åˆåŠ å·¥,æé«˜æ•ˆç‡
4. æ¢ç´¢äº§åœ°ç›´é‡‡æ¨¡å¼,é™ä½ä¸­é—´ç¯èŠ‚æˆæœ¬

é¢„æœŸæ•ˆæœ: é™ä½é£Ÿææˆæœ¬2-3ä¸ªç™¾åˆ†ç‚¹,å¹´èŠ‚çº¦æˆæœ¬30-40ä¸‡å…ƒ
                """,
                "action_items": [
                    {
                        "task": "å®Œæˆä¾›åº”å•†æ•´åˆæ–¹æ¡ˆ",
                        "owner": "é‡‡è´­éƒ¨ç»ç†",
                        "deadline": "11-15"
                    },
                    {
                        "task": "è°ƒç ”åº“å­˜ç®¡ç†ç³»ç»Ÿ",
                        "owner": "ITéƒ¨ç»ç†",
                        "deadline": "11-20"
                    },
                    {
                        "task": "è¯„ä¼°ä¸­å¤®å¨æˆ¿å¯è¡Œæ€§",
                        "owner": "æè¿è¥æ€»ç›‘",
                        "deadline": "11-30"
                    }
                ]
            }
        ],
        "next_meeting": "ä¸‹æ¬¡ä¼šè®®å®šäº11æœˆ15æ—¥14:00,åœ°ç‚¹å¾…å®š,è®®é¢˜ä¸ºQ4ä¸­æœŸè¿›å±•reviewå’Œæ–°åº—é€‰å€æœ€ç»ˆå†³ç­–ã€‚"
    }

    result = create_from_template(
        template_type="meeting-minutes",
        data=data,
        output_path="output/è¡Œæ”¿ç»„/ä¼šè®®çºªè¦/strategy-meeting-20251021.docx"
    )

    if result["success"]:
        print(f"âœ… ä¼šè®®çºªè¦å·²ç”Ÿæˆ: {result['file_path']}")
        print(f"ğŸ“„ æ–‡ä»¶å¤§å°: {result['size_bytes']:,} bytes")
    else:
        print(f"âŒ ç”Ÿæˆå¤±è´¥: {result['error']}")


if __name__ == "__main__":
    create_meeting_minutes()
