"""
Example: Business Report Generation

This example demonstrates creating a comprehensive business report
with various formatting elements.
"""

import sys
from pathlib import Path

# Add skill to path
skill_path = Path(__file__).parent.parent / "scripts"
sys.path.insert(0, str(skill_path))

from word_generator import create_document


def create_business_report():
    """Create a sample business report."""

    content = [
        # Executive Summary
        {"type": "heading", "level": 1, "text": "æ‰§è¡Œæ‘˜è¦"},
        {
            "type": "paragraph",
            "text": "æœ¬æŠ¥å‘Šæ€»ç»“äº†2025å¹´ç¬¬ä¸‰å­£åº¦çš„ç»è¥æƒ…å†µã€‚æ•´ä½“ä¸šç»©è‰¯å¥½ï¼Œè¥ä¸šé¢åŒæ¯”å¢é•¿25%ï¼Œè¾¾åˆ°450ä¸‡å…ƒã€‚ä¸»è¦å¢é•¿æ¥è‡ªæ–°å“æ¨å‡ºå’Œçº¿ä¸Šæ¸ é“æ‰©å¼ ã€‚"
        },

        # Section 1: Sales Performance
        {"type": "heading", "level": 1, "text": "ä¸€ã€é”€å”®ä¸šç»©"},
        {"type": "heading", "level": 2, "text": "1.1 æ€»ä½“æƒ…å†µ"},
        {
            "type": "paragraph",
            "text": "Q3å­£åº¦å„é—¨åº—é”€å”®æƒ…å†µå¦‚ä¸‹ï¼š"
        },
        {
            "type": "table",
            "headers": ["é—¨åº—", "è¥ä¸šé¢(ä¸‡å…ƒ)", "åŒæ¯”å¢é•¿", "ç¯æ¯”å¢é•¿"],
            "rows": [
                ["Aåº—(æ€»åº—)", "150", "+25%", "+10%"],
                ["Båº—(åˆ†åº—)", "120", "+20%", "+8%"],
                ["Cåº—(æ–°åº—)", "80", "æ–°å¼€", "æ–°å¼€"],
                ["çº¿ä¸Šæ¸ é“", "100", "+50%", "+20%"],
                ["åˆè®¡", "450", "+25%", "+12%"]
            ]
        },

        {"type": "heading", "level": 2, "text": "1.2 å…³é”®æ´å¯Ÿ"},
        {
            "type": "bullet_list",
            "items": [
                "æ–°åº—Cåº—å¼€ä¸šç¬¬ä¸€ä¸ªæœˆå³è¾¾åˆ°é¢„æœŸç›®æ ‡çš„80%",
                "çº¿ä¸Šæ¸ é“å¢é•¿è¿…çŒ›ï¼Œå æ€»è¥ä¸šé¢çš„22%",
                "Aåº—ä½œä¸ºæ——èˆ°åº—ä¿æŒç¨³å®šå¢é•¿",
                "å¤–å–ä¸šåŠ¡å æ¯”æå‡è‡³35%"
            ]
        },

        # Section 2: Product Analysis
        {"type": "heading", "level": 1, "text": "äºŒã€äº§å“åˆ†æ"},
        {"type": "heading", "level": 2, "text": "2.1 æ–°å“è¡¨ç°"},
        {
            "type": "paragraph",
            "text": "Q3æ¨å‡ºçš„3æ¬¾æ–°å“è¡¨ç°ä¼˜å¼‚ï¼š"
        },
        {
            "type": "numbered_list",
            "items": [
                "éº»è¾£å°é¾™è™¾ç«é”… - é”€é‡ç¬¬1ï¼Œè´¡çŒ®è¥ä¸šé¢15%",
                "å…»ç”ŸèŒæ±¤é”…åº• - å®¢å•ä»·æœ€é«˜ï¼Œæå‡å“ç‰Œå½¢è±¡",
                "å¤æ—¥ç‰¹é¥®ç³»åˆ— - å¸¦åŠ¨é¥®å“é”€å”®å¢é•¿40%"
            ]
        },

        {"type": "heading", "level": 2, "text": "2.2 äº§å“ä¼˜åŒ–å»ºè®®"},
        {
            "type": "bullet_list",
            "items": [
                "ç»§ç»­æ¨å¹¿æ–°å“ï¼Œå»ºè®®å¢åŠ ä¿ƒé”€åŠ›åº¦",
                "ä¼˜åŒ–ä¼ ç»Ÿèœå“ï¼Œé™ä½æˆæœ¬æå‡åˆ©æ¶¦",
                "å¼€å‘ç§‹å†¬å­£èŠ‚é™å®šäº§å“",
                "åŠ å¼ºäº§å“è´¨é‡ç®¡æ§"
            ]
        },

        # Section 3: Cost Analysis
        {"type": "heading", "level": 1, "text": "ä¸‰ã€æˆæœ¬åˆ†æ"},
        {
            "type": "paragraph",
            "text": "ä¸»è¦æˆæœ¬é¡¹ç›®å æ¯”å¦‚ä¸‹ï¼š"
        },
        {
            "type": "table",
            "headers": ["æˆæœ¬é¡¹ç›®", "é‡‘é¢(ä¸‡å…ƒ)", "å è¥ä¸šé¢æ¯”ä¾‹", "åŒæ¯”å˜åŒ–"],
            "rows": [
                ["é£Ÿææˆæœ¬", "135", "30%", "+2%"],
                ["äººåŠ›æˆæœ¬", "90", "20%", "+5%"],
                ["æˆ¿ç§Ÿæ°´ç”µ", "45", "10%", "æŒå¹³"],
                ["è¥é”€è´¹ç”¨", "27", "6%", "+3%"],
                ["å…¶ä»–è´¹ç”¨", "18", "4%", "+1%"],
                ["åˆè®¡", "315", "70%", "+2.5%"]
            ]
        },

        # Section 4: Issues and Solutions
        {"type": "heading", "level": 1, "text": "å››ã€é—®é¢˜ä¸å¯¹ç­–"},
        {"type": "heading", "level": 2, "text": "4.1 ä¸»è¦é—®é¢˜"},
        {
            "type": "numbered_list",
            "items": [
                "äººåŠ›æˆæœ¬ä¸Šå‡æ˜æ˜¾ï¼Œå‘˜å·¥æµå¤±ç‡åé«˜",
                "éƒ¨åˆ†é£Ÿæä»·æ ¼ä¸Šæ¶¨ï¼Œå½±å“åˆ©æ¶¦ç‡",
                "ç«äº‰å¯¹æ‰‹å¼€ä¸šï¼Œå¯¹Båº—äº§ç”Ÿä¸€å®šå½±å“",
                "æ–°åº—è¿è¥ç»éªŒä¸è¶³ï¼Œéœ€è¦æ€»éƒ¨æ”¯æŒ"
            ]
        },

        {"type": "heading", "level": 2, "text": "4.2 åº”å¯¹æªæ–½"},
        {
            "type": "bullet_list",
            "items": [
                "ä¼˜åŒ–è–ªé…¬ä½“ç³»ï¼ŒåŠ å¼ºå‘˜å·¥åŸ¹è®­å’Œæ¿€åŠ±",
                "ä¸ä¾›åº”å•†è°ˆåˆ¤ï¼Œç­¾è®¢é•¿æœŸåˆä½œåè®®é”å®šä»·æ ¼",
                "åŠ å¼ºå“ç‰Œè¥é”€ï¼Œçªå‡ºå·®å¼‚åŒ–ä¼˜åŠ¿",
                "æ´¾é£èµ„æ·±åº—é•¿æ”¯æŒæ–°åº—ï¼Œå»ºç«‹æ ‡å‡†åŒ–è¿è¥ä½“ç³»"
            ]
        },

        # Section 5: Q4 Plan
        {"type": "heading", "level": 1, "text": "äº”ã€Q4è¡ŒåŠ¨è®¡åˆ’"},
        {
            "type": "table",
            "headers": ["è¡ŒåŠ¨é¡¹", "è´Ÿè´£äºº", "å®Œæˆæ—¶é—´", "é¢„æœŸæ•ˆæœ"],
            "rows": [
                ["æ¨å‡ºç§‹å†¬æ–°å“3æ¬¾", "äº§å“éƒ¨", "10æœˆåº•", "æå‡10%è¥ä¸šé¢"],
                ["å¯åŠ¨ä¼šå‘˜è¥é”€æ´»åŠ¨", "è¥é”€éƒ¨", "11æœˆåˆ", "å¢åŠ 5000ä¼šå‘˜"],
                ["ä¼˜åŒ–ä¾›åº”é“¾æˆæœ¬", "é‡‡è´­éƒ¨", "æŒç»­è¿›è¡Œ", "é™ä½2%æˆæœ¬"],
                ["æ–°åº—è¿è¥åŸ¹è®­", "è¿è¥éƒ¨", "10æœˆä¸­", "æå‡æ–°åº—æ•ˆç‡"]
            ]
        },

        # Conclusion
        {"type": "heading", "level": 1, "text": "å…­ã€æ€»ç»“"},
        {
            "type": "paragraph",
            "text": "Q3æ•´ä½“è¡¨ç°è‰¯å¥½ï¼Œè¾¾æˆäº†å­£åº¦ç›®æ ‡ã€‚Q4å°†ç»§ç»­ä¿æŒå¢é•¿åŠ¿å¤´ï¼Œé‡ç‚¹å…³æ³¨æˆæœ¬æ§åˆ¶å’Œæ–°åº—è¿è¥ï¼ŒåŠ›äº‰å…¨å¹´è¥ä¸šé¢çªç ´1800ä¸‡å…ƒï¼Œå®ç°30%çš„åŒæ¯”å¢é•¿ã€‚"
        }
    ]

    result = create_document(
        title="2025å¹´Q3ç»è¥åˆ†ææŠ¥å‘Š",
        content=content,
        output_path="output/è¡Œæ”¿ç»„/ç»è¥åˆ†æ/q3-business-report.docx",
        author="æ•°æ®åˆ†æç»„"
    )

    if result["success"]:
        print(f"âœ… æŠ¥å‘Šå·²ç”Ÿæˆ: {result['file_path']}")
        print(f"ğŸ“„ æ–‡ä»¶å¤§å°: {result['size_bytes']:,} bytes")
    else:
        print(f"âŒ ç”Ÿæˆå¤±è´¥: {result['error']}")


if __name__ == "__main__":
    create_business_report()
