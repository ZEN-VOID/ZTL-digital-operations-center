#!/usr/bin/env python3
"""
云南过桥米线营销方案 - 增强版PPT生成脚本
使用EnhancedPPTGenerator创建充满设计感的PPT
"""

import sys
from pathlib import Path

# 添加scripts目录到Python路径
scripts_dir = Path(__file__).parent.parent.parent.parent / '.claude' / 'skills' / 'office' / 'ppt' / 'scripts'
sys.path.insert(0, str(scripts_dir))

from enhanced_ppt_generator import EnhancedPPTGenerator

def main():
    """生成云南过桥米线营销方案增强版PPT"""

    print("=" * 60)
    print("🎨 云南过桥米线营销方案 - 增强版PPT生成器")
    print("=" * 60)
    print()

    # 创建生成器实例
    generator = EnhancedPPTGenerator()
    print("✅ 初始化增强版PPT生成器 (2025设计标准)")
    print()

    # ========== 第一部分: 开篇 (3页) ==========
    print("📄 第一部分: 开篇 (3页)")

    # 1. 封面页
    generator.add_title_slide(
        "云南过桥米线\n品牌营销策划方案",
        '"一碗过桥,三餐云南" | 2025年10月'
    )
    print("  ✓ Slide 1: 封面页 (渐变背景)")

    # 2. 目录页
    generator.add_content_slide(
        "目 录",
        [
            "01. 项目概览 - 营销主题与核心理念",
            "02. 品牌分析 - 目标客群与市场洞察",
            "03. 创意策略 - 三大核心营销创意",
            "04. 执行方案 - 线上线下整合传播",
            "05. 预算与ROI - 投入产出分析"
        ]
    )
    print("  ✓ Slide 2: 目录 (卡片式布局)")

    # 3. 项目概览
    generator.add_content_slide(
        "项目概览",
        [
            "🎯 营销主题: 一碗过桥,三餐云南",
            "💡 核心理念: 场景创新 × 文化体验 × 社交传播",
            "📅 执行周期: 2025年5-9月 (5个月)",
            "💰 预算规模: 80万元",
            "📈 预期ROI: 投入产出比1:3.5,预计新增280万营收"
        ]
    )
    print("  ✓ Slide 3: 项目概览 (要点列表)")
    print()

    # ========== 第二部分: 品牌分析 (5页) ==========
    print("📊 第二部分: 品牌分析 (5页)")

    # 4. 目标客群画像
    generator.add_two_column_slide(
        "目标客群画像",
        [
            "🎯 核心人群 (60%)",
            "• 年龄: 25-40岁都市白领",
            "• 特征: 追求品质生活,注重健康养生",
            "• 行为: 社交媒体活跃,愿意为体验买单",
            "• 痛点: 午餐选择单一,缺乏仪式感"
        ],
        [
            "🎯 次级人群 (40%)",
            "• 年龄: 18-25岁Z世代学生",
            "• 特征: 喜欢新鲜体验,追求性价比",
            "• 行为: 拍照分享达人,KOL影响力强",
            "• 痛点: 想要尝鲜但担心踩雷"
        ]
    )
    print("  ✓ Slide 4: 目标客群画像 (双栏对比)")

    # 5. 核心卖点提炼
    generator.add_two_column_slide(
        "核心卖点提炼",
        [
            "📦 产品层",
            "• 正宗云南味道 - 非遗传承工艺",
            "• 过桥仪式感 - 100度鲜汤现烫",
            "• 食材新鲜度 - 每日现切现配",
            "• 营养健康 - 低脂高蛋白组合"
        ],
        [
            "❤️ 情感层",
            "• 文化体验 - 云南少数民族风情",
            "• 社交货币 - 拍照打卡必选地",
            "• 场景适配 - 早中晚三餐皆宜",
            "• 记忆触发 - 唤起云南旅行回忆"
        ]
    )
    print("  ✓ Slide 5: 核心卖点提炼 (双栏结构)")

    # 6. 市场机会洞察
    generator.add_content_slide(
        "市场机会洞察 - 2025年餐饮营销5大趋势",
        [
            "🔥 场景革命: 突破单一用餐场景,抢占早餐/宵夜新赛道",
            "🎭 文化IP: 地域特色+非遗故事=高溢价空间",
            "📱 社交传播: UGC内容成本仅为传统广告的1/5",
            "🎯 精准触达: 小红书+抖音双平台覆盖年轻客群",
            "💡 体验经济: 仪式感>产品本身,愿为体验多付30%"
        ]
    )
    print("  ✓ Slide 6: 市场机会洞察 (趋势分析)")

    # 7. 竞品定位对比表格
    generator.add_table_slide(
        "竞品定位对比分析",
        ["品牌", "定位", "价格带", "优势", "劣势"],
        [
            ["蒙自源", "正宗派", "25-35元", "品牌认知度高", "创新不足"],
            ["云海肴", "体验派", "40-60元", "环境好服务佳", "价格偏高"],
            ["阿香米线", "快餐派", "15-25元", "性价比高", "缺乏特色"],
            ["某品牌", "文化派", "30-45元", "仪式感+社交", "待建立认知"]
        ]
    )
    print("  ✓ Slide 7: 竞品定位对比 (数据表格)")

    # 8. SWOT分析
    generator.add_two_column_slide(
        "SWOT战略分析",
        [
            "💪 Strengths 优势",
            "• 正宗云南非遗传承工艺",
            "• 过桥仪式感独特体验",
            "",
            "⚠️ Weaknesses 劣势",
            "• 品牌知名度有待提升",
            "• 消费场景认知局限"
        ],
        [
            "🌟 Opportunities 机会",
            "• 三餐场景营销蓝海市场",
            "• 文化IP打造溢价空间",
            "",
            "⚡ Threats 威胁",
            "• 快餐品牌价格竞争",
            "• 同质化产品涌现风险"
        ]
    )
    print("  ✓ Slide 8: SWOT分析 (四象限)")
    print()

    # ========== 第三部分: 创意策略 (7页) ==========
    print("🎨 第三部分: 创意策略 (7页)")

    # 9. 营销主题解读
    generator.add_content_slide(
        '营销主题解读: "一碗过桥,三餐云南"',
        [
            "🌅 一碗 = 产品聚焦: 用一碗米线讲好云南故事",
            "🌉 过桥 = 仪式感: 100度鲜汤过桥,唤醒感官记忆",
            "🍜 三餐 = 场景革命: 早中晚全场景,突破午餐单一认知",
            "🏔️ 云南 = 文化IP: 云南非遗+少数民族风情=高溢价"
        ]
    )
    print("  ✓ Slide 9: 营销主题解读")

    # 10. 核心创意1 - 过桥三部曲
    generator.add_content_slide(
        '核心创意1: "过桥三部曲" 场景营销',
        [
            "☀️ 早餐场景 - '元气过桥,开启云南早晨'",
            "   定位: 轻食早餐,营养健康 | 客单价: 20-25元",
            "",
            "🍱 午餐场景 - '正宗过桥,云南味道正当时'",
            "   定位: 商务简餐,高效美味 | 客单价: 30-40元",
            "",
            "🌙 宵夜场景 - '深夜过桥,温暖不打烊'",
            "   定位: 夜宵治愈,社交聚会 | 客单价: 35-50元"
        ]
    )
    print("  ✓ Slide 10: 核心创意1 - 过桥三部曲")

    # 11. 核心创意2 - 云南寻味地图
    generator.add_content_slide(
        '核心创意2: "云南寻味地图" 文化IP',
        [
            "🗺️ IP概念: 打造云南26个民族风味寻味地图",
            "📖 故事线: 每月主推一个民族特色米线 (彝族/傣族/白族...)",
            "🎁 会员权益: 集齐12个民族印章,兑换'云南寻味大使'称号",
            "🎬 内容营销: 拍摄非遗传承人纪录片,KOL探店寻味",
            "🏆 UGC激励: 用户分享'我的云南记忆'故事,月度评选奖励"
        ]
    )
    print("  ✓ Slide 11: 核心创意2 - 云南寻味地图")

    # 12. 核心创意3 - 隐藏吃法
    generator.add_content_slide(
        '核心创意3: "隐藏吃法解锁" 用户共创',
        [
            "🎮 游戏化: 仿照游戏'隐藏菜单'概念,设计12种隐藏吃法",
            "📱 小程序: 开发'米线炼金术'小程序,用户自由搭配配料",
            "🏅 激励机制: 首个发现隐藏吃法用户,获得终身8折卡",
            "📹 UGC产出: 用户分享创意吃法短视频,官方账号转发推荐",
            "💡 案例参考: 喜茶'多肉葡萄'用户自创,官方采纳爆款"
        ]
    )
    print("  ✓ Slide 12: 核心创意3 - 隐藏吃法解锁")

    # 13-14. AIGC素材展示页
    # 检查AIGC图片是否存在
    poster_path = Path("/Users/vincentlee/Desktop/ZTL数智化作战中心/output/创意组/AIGC生成/images/1-poster/1-poster_20251021_040057_1.png")
    product_path = Path("/Users/vincentlee/Desktop/ZTL数智化作战中心/output/创意组/AIGC生成/images/8-main-image/8-main-image_20251021_040135_1.png")

    if poster_path.exists():
        generator.add_image_slide(
            "主视觉设计 - 活动海报",
            str(poster_path),
            "AIGC生成: 彝族火焰红主色调,展现仪式感和文化传承"
        )
        print("  ✓ Slide 13: 主视觉海报 (AIGC图片)")
    else:
        generator.add_content_slide(
            "主视觉设计 - 活动海报",
            [
                "🎨 设计风格: 现代中式美食风格",
                "🔥 主色调: 彝族火焰红 (#D84315)",
                "✨ 视觉元素: 热气腾腾的米线+云南建筑剪影",
                "📐 设计要求: 竖版海报 (9:16),适配手机端展示",
                "💫 AIGC生成: 基于Gemini 2.5 Flash模型"
            ]
        )
        print("  ✓ Slide 13: 主视觉海报设计说明")

    if product_path.exists():
        generator.add_image_slide(
            "产品摄影 - 美食主图",
            str(product_path),
            "AIGC生成: 100度鲜汤热气腾腾,专业美食杂志质感"
        )
        print("  ✓ Slide 14: 产品摄影 (AIGC图片)")
    else:
        generator.add_content_slide(
            "产品摄影 - 美食主图",
            [
                "📸 拍摄角度: 45度俯拍,特写视角",
                "🍜 核心元素: 100度鲜汤冒着热气,新鲜牛肉片/鹌鹑蛋",
                "🎨 色彩处理: 高饱和度,暖色调,食欲激发",
                "💎 质感要求: 高端美食杂志级别",
                "💫 AIGC生成: 横版主图 (16:9),电商展示专用"
            ]
        )
        print("  ✓ Slide 14: 产品摄影设计说明")

    # 15. 成功案例参考
    generator.add_content_slide(
        "成功案例参考 - 行业标杆学习",
        [
            "🧋 喜茶: '多肉葡萄'用户共创,单品年销500万杯",
            "   借鉴点: UGC内容激励机制,用户自创配方官方采纳",
            "",
            "🍲 海底捞: '抖音隐藏吃法'传播,带动客流增长35%",
            "   借鉴点: 游戏化隐藏菜单,社交媒体病毒式传播",
            "",
            "☕ 瑞幸: '酱香拿铁'文化联名,单日销售542万杯",
            "   借鉴点: 地域文化IP打造,跨界联名制造话题"
        ]
    )
    print("  ✓ Slide 15: 成功案例参考")
    print()

    # ========== 第四部分: 执行方案 (10页) ==========
    print("🚀 第四部分: 执行方案 (10页)")

    # 16. 线上推广矩阵
    generator.add_content_slide(
        "线上推广矩阵 - 三大核心渠道",
        [
            "📱 小红书 (种草阵地): 美食探店+文化体验",
            "   KOL合作: 头部3位+腰部10位+素人100位",
            "",
            "🎬 抖音 (流量引擎): 短视频+直播双驱动",
            "   话题运营: #一碗过桥三餐云南 挑战赛",
            "",
            "💬 微信生态 (私域运营): 小程序+公众号+社群",
            "   会员体系: 云南寻味地图集章计划"
        ]
    )
    print("  ✓ Slide 16: 线上推广矩阵")

    # 17. 小红书推广策略
    generator.add_two_column_slide(
        "小红书推广策略",
        [
            "👥 KOL层级配置",
            "• 头部KOL (3位): 50万+粉丝",
            "• 腰部KOL (10位): 10-50万粉丝",
            "• 素人KOC (100位): 1-10万粉丝"
        ],
        [
            "📝 内容方向",
            "• 探店打卡: 过桥仪式感全记录",
            "• 文化故事: 云南非遗美食科普",
            "• 隐藏吃法: 创意搭配教程"
        ]
    )
    print("  ✓ Slide 17: 小红书推广策略")

    # 18. 抖音推广策略
    generator.add_two_column_slide(
        "抖音推广策略",
        [
            "🎯 话题运营",
            "• #一碗过桥三餐云南",
            "• #隐藏吃法解锁挑战",
            "• #云南寻味记",
            "• 目标: 1000万曝光"
        ],
        [
            "💰 投放策略",
            "• DOU+推广: 精准定向投放",
            "• 达人合作: 美食垂类KOL",
            "• 挑战赛: UGC内容激励",
            "• 直播带货: 限时秒杀活动"
        ]
    )
    print("  ✓ Slide 18: 抖音推广策略")

    # 19. 微信生态运营
    generator.add_content_slide(
        "微信生态运营 - 私域流量池",
        [
            "📱 小程序: '云南过桥米线' 点单+会员系统",
            "   功能: 在线点单/会员积分/隐藏吃法解锁/寻味地图",
            "",
            "📰 公众号: 品牌故事+营销活动推送",
            "   内容: 每周云南美食文化专栏 (周三发布)",
            "",
            "💬 社群运营: 米线粉丝俱乐部",
            "   福利: 新品试吃/专属折扣/线下活动优先报名"
        ]
    )
    print("  ✓ Slide 19: 微信生态运营")

    # 20. 线下活动1 - 快闪店
    generator.add_content_slide(
        '线下活动1: "过桥时光馆" 快闪店',
        [
            "📍 选址: 三里屯/静安寺等核心商圈",
            "⏰ 时间: 5-6月,每场7天",
            "🎨 设计: 云南少数民族风情沉浸式体验",
            "🎁 活动: 免费试吃/拍照打卡/非遗手作体验",
            "📊 目标: 单场吸引5000+人次,获得1000+UGC内容"
        ]
    )
    print("  ✓ Slide 20: 线下活动1 - 过桥时光馆")

    # 21. 线下活动2 - 米线音乐节
    generator.add_content_slide(
        '线下活动2: "米线音乐节" 跨界合作',
        [
            "🎵 合作对象: 本地独立音乐厂牌/LiveHouse",
            "🎤 活动形式: 音乐演出+美食集市",
            "🍜 特色: '边吃边听'沉浸式体验",
            "🎫 门票: 99元 (含米线套餐+音乐会)",
            "📈 预期: 单场300人,传播触达10万+年轻客群"
        ]
    )
    print("  ✓ Slide 21: 线下活动2 - 米线音乐节")

    # 22. 线下活动3 - 云南之旅
    generator.add_content_slide(
        '线下活动3: "云南寻味之旅" 会员专享',
        [
            "✈️ 活动形式: 组织会员前往云南实地探访",
            "🗺️ 行程亮点: 蒙自过桥米线发源地+非遗传承人访谈",
            "👥 参与对象: 集齐12个民族印章的'寻味大使'",
            "💰 补贴政策: 品牌补贴50%旅费",
            "📹 内容产出: 纪录片素材+用户Vlog,二次传播"
        ]
    )
    print("  ✓ Slide 22: 线下活动3 - 云南寻味之旅")

    # 23. 整合传播时间轴
    generator.add_content_slide(
        "整合传播时间轴 (5-9月)",
        [
            "📅 5月 造势期: 快闪店启动 + KOL种草 + 话题预热",
            "📅 6月 爆发期: 抖音挑战赛 + 米线音乐节 + DOU+投放",
            "📅 7月 深化期: 云南寻味地图上线 + 会员体系启动",
            "📅 8月 持续期: UGC内容沉淀 + 隐藏吃法推广",
            "📅 9月 收官期: 数据复盘 + ROI评估 + 优化迭代"
        ]
    )
    print("  ✓ Slide 23: 整合传播时间轴")

    # 24. KOL合作矩阵表格
    generator.add_table_slide(
        "KOL合作矩阵与预算分配",
        ["层级", "数量", "粉丝量", "单价", "预算", "产出"],
        [
            ["头部KOL", "3位", "50万+", "3万/篇", "9万", "深度探店长图文"],
            ["腰部KOL", "10位", "10-50万", "8000/篇", "8万", "美食测评视频"],
            ["素人KOC", "100位", "1-10万", "500/篇", "5万", "打卡分享笔记"],
            ["抖音达人", "5位", "100万+", "2万/条", "10万", "创意短视频"]
        ]
    )
    print("  ✓ Slide 24: KOL合作矩阵")

    # 25. 线下活动执行排期
    generator.add_table_slide(
        "线下活动执行排期表",
        ["时间", "活动名称", "地点", "预算", "目标人次"],
        [
            ["5月中旬", "过桥时光馆 - 北京站", "三里屯", "8万", "5000人"],
            ["5月下旬", "过桥时光馆 - 上海站", "静安寺", "8万", "5000人"],
            ["6月上旬", "米线音乐节 Vol.1", "北京LiveHouse", "5万", "300人"],
            ["6月下旬", "米线音乐节 Vol.2", "上海LiveHouse", "5万", "300人"],
            ["7-9月", "云南寻味之旅", "云南蒙自", "10万", "50人"]
        ]
    )
    print("  ✓ Slide 25: 线下活动排期表")
    print()

    # ========== 第五部分: 预算与ROI (3页) ==========
    print("💰 第五部分: 预算与ROI (3页)")

    # 26. 预算分配明细
    generator.add_content_slide(
        "80万预算分配方案",
        [
            "📱 线上推广 (40万, 50%): KOL合作 + DOU+投放 + 信息流广告",
            "🎪 线下活动 (26万, 32.5%): 快闪店 + 音乐节 + 云南之旅",
            "🎨 内容制作 (10万, 12.5%): 短视频/海报/H5/纪录片制作",
            "💻 技术开发 (4万, 5%): 小程序开发 + 会员系统搭建"
        ]
    )
    print("  ✓ Slide 26: 预算分配概览")

    # 27. 预算明细表格
    generator.add_table_slide(
        "预算明细分项表",
        ["类目", "项目", "预算", "占比"],
        [
            ["线上推广", "小红书KOL合作", "22万", "27.5%"],
            ["线上推广", "抖音投放+达人", "18万", "22.5%"],
            ["线下活动", "快闪店(2场)", "16万", "20%"],
            ["线下活动", "音乐节(2场)", "10万", "12.5%"],
            ["内容制作", "视频/设计制作", "10万", "12.5%"],
            ["技术开发", "小程序+会员系统", "4万", "5%"]
        ]
    )
    print("  ✓ Slide 27: 预算明细表")

    # 28. ROI预期
    generator.add_two_column_slide(
        "ROI预期与长期价值",
        [
            "📊 短期目标 (3个月)",
            "• 新增会员: 8000人",
            "• 客单价提升: 10%",
            "• 营收增长: 280万",
            "• 投入产出比: 1:3.5",
            "• 社交媒体曝光: 5000万+"
        ],
        [
            "🌟 长期价值 (6-12个月)",
            "• 品牌知名度提升40%",
            "• 私域流量池: 2万+",
            "• 复购率提升至45%",
            "• UGC内容资产沉淀",
            "• 加盟咨询量增长3倍"
        ]
    )
    print("  ✓ Slide 28: ROI预期分析")
    print()

    # ========== 第六部分: 收尾 (2页) ==========
    print("🎯 第六部分: 收尾 (2页)")

    # 29. 风险控制
    generator.add_two_column_slide(
        "风险控制与质量保障",
        [
            "⚠️ 潜在风险",
            "• KOL数据造假风险",
            "• UGC内容质量参差不齐",
            "• 快闪店客流不及预期",
            "• 竞品跟进模仿"
        ],
        [
            "✅ 应对措施",
            "• 严格筛选KOL,验证真实数据",
            "• 设计UGC模板,提供拍摄指导",
            "• 选址前期调研,备选方案",
            "• 建立专利壁垒,IP法律保护"
        ]
    )
    print("  ✓ Slide 29: 风险控制")

    # 30. 感谢页
    generator.add_title_slide(
        "谢谢观看",
        '"一碗过桥,三餐云南"\n让云南非遗美食走进千家万户'
    )
    print("  ✓ Slide 30: 感谢页 (渐变背景)")
    print()

    # 保存PPT
    output_path = Path(__file__).parent / "云南过桥米线营销方案_设计加强版.pptx"
    generator.save(str(output_path))

    print("=" * 60)
    print("✅ PPT生成完成!")
    print(f"📁 文件路径: {output_path}")
    print(f"📄 幻灯片数量: 30页")

    # 获取文件大小
    file_size = output_path.stat().st_size
    print(f"📦 文件大小: {file_size:,} bytes ({file_size / 1024 / 1024:.2f} MB)")
    print()
    print("🎨 设计特色:")
    print("  ✓ 渐变背景 (封面/结尾页)")
    print("  ✓ 卡片式布局 (内容页)")
    print("  ✓ 柔和阴影效果 (深度感)")
    print("  ✓ 现代配色方案 (橙/蓝/金)")
    print("  ✓ 专业表格设计 (斑马纹)")
    print("=" * 60)

if __name__ == "__main__":
    main()
